---
title: "phylogenetic signal"
---

## phylomorphospace

```{r message=FALSE, warning=FALSE, cache=TRUE}
library(phytools)
library(geiger)
library(dplyr)

astrag <- read.table("http://hompal-stats.wabarr.com/datasets/barr_astrag_2014.txt", header=TRUE, sep="\t")
astrag <- mutate(astrag, geomean = (B*DistRad*LML*MIN*MML*ProxRad*WAF*WAT) ^ (1/8)) %>%
  filter(Taxon != "Nanger_soemmerringii")

mean_B_DistRad <- group_by(astrag, Taxon) %>% 
  summarise(B=mean(B/geomean), DistRad=mean(DistRad/geomean)) 


tip_matrix <- as.matrix(mean_B_DistRad[c("B", "DistRad")])
row.names(tip_matrix) <- mean_B_DistRad$Taxon

ruminant <- read.tree("http://hompal-stats.wabarr.com/datasets/ruminants.phy")

nonBovids <- name.check(ruminant, astrag, data.names = astrag$Taxon)$tree_not_data

bovids <- drop.tip(phy = ruminant, tip = nonBovids)


phylomorphospace(tree = bovids, X = tip_matrix, )
```