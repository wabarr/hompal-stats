<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Hypothesis Testing</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57395681-1', 'auto');
  ga('send', 'pageview');

</script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="icon" href="favicon.ico" type="image/x-icon">

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/textmate.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="octicons/octicons.css" type="text/css" />
<link rel="stylesheet" href="css/custom-style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<div id="navbar">
  <div id="navbar-container">
    <ul id="navbar-ul">
      <li><a href="index.html"><span class="mega-octicon octicon-home"></span></a></li>
      <li><a href="datasets.html">Data</a></li>
      <li><a href="schedule.html">Schedule</a></li>
      <li><a href="ANTH6413_syllabus.docx">Syllabus</a></li>
      <li><a href="gettinghelp.html">Getting Help</a></li>
      
    </ul>
  </div>
</div>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Hypothesis Testing</h1>

</div>


<div id="induction-versus-deduction" class="section level2">
<h2>Induction versus Deduction</h2>
<p>Inductive reasoning is the “bottom-up” approach to reasoning. Proceeding from specific observations to general explanations. Deduction goes the other way: from general to specific. All methods of doing science use both inductive and deductive reasoning, but the emphasis that they receive differs.</p>
<div id="deduction" class="section level3">
<h3>Deduction</h3>
<ul>
<li>Emphasis is on falsification</li>
<li>Requires multiple working hypotheses</li>
<li>In the end, there is (hopefully) only one that hasn’t been falsified</li>
<li>Limitation: “correct” hypothesis MUST be among the alternatives studied</li>
</ul>
<div class="figure">
<img src="hypothetico_deductive.png" alt="hypotheticodeductive" />
<p class="caption">hypotheticodeductive</p>
</div>
</div>
<div id="induction" class="section level3">
<h3>Induction</h3>
<ul>
<li>Emphasis is on confirmation</li>
<li>Builds and modifies hypothesis based on previous knowledge</li>
<li>Limitation: may “get off on wrong foot” if hypothesis is just plain wrong</li>
</ul>
<div class="figure">
<img src="inductive.png" alt="induction" />
<p class="caption">induction</p>
</div>
</div>
</div>
<div id="testing-hypotheses" class="section level2">
<h2>Testing Hypotheses</h2>
<p>Consider a <a href="datasets/baboons.txt">fake dataset of body mass and femoral head diameters</a> from male and female baboons.</p>
<p><span class="mega-octicon octicon-puzzle"></span> Read this into R on your own, and make a boxplot like the one below, with the points overlaid on the boxes.</p>
<p><img src="OLDhypothesis_testing_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Suppose we want to test the scientific hypothesis that there is a relationship between sex and femoral head diamter. To do this, we first create a statistical null hypothesis.</p>
<div id="the-null-hypothesis" class="section level3">
<h3>The null hypothesis</h3>
<p>The null hypothesis is the simplest possible explanation for a phenomenon. This explanation is usually that random variation is responsible for any apparent pattern.</p>
<p>In the case of our baboons, the null hypothesis is that femoral head diameter is in NO way related to sex, and that any apparent association between the two is due to random chance.</p>
</div>
<div id="alternatives-to-the-null" class="section level3">
<h3>Alternatives to the null</h3>
<p>Next, we create one or more statistical alternative hypotheses. In our baboon case, the alternative is that the difference between male and female femoral head diameters is too great to be accounted for by chance alone. Most of the time, we don’t explicitly specify the alternative, we just suffice it so say that the alternative is “not <span class="math inline">\(H_0\)</span>”</p>
<p><span class="mega-octicon octicon-alert"></span> The alternative hypothesis is simply focussed on the pattern in the data…not the cause of it.</p>
</div>
<div id="the-all-powerful-p-value" class="section level3">
<h3>The all powerful p-value</h3>
<div id="the-p-value-is-an-estimate-of-how-likely-our-data-are-assuming-the-null-hypothesis-is-true." class="section level4">
<h4>The p-value is an estimate of how likely our data are, assuming the null hypothesis is true.</h4>
<p>In terms of conditional probability, the p value represents <span class="math display">\[ P(Data|H_0) \]</span></p>
<p>If we have a very small p-value, this implies that it is very unlikely to observe data that are as extreme as our data, assuming the null hypothesis is true. In the case of our baboons, we would probably use a T-test to compare group means. Like all parametric statistics, the T-test returns a <strong><em>test statistic</em></strong> that is in this case called T, and measures how far the group means are from one another. Because we are assuming that the null hypothesis is true for the moment, we can compute a disribution of how likely it is to get various values of T when there are no differences between groups.</p>
<pre class="r"><code>library(ggplot2)
xrange &lt;- seq(-15, 15, 0.05)
qplot(x=xrange, y=dt(xrange, df = 1000), geom=&quot;line&quot;,  main=&quot;Density of T-Distribution df=1000&quot;)</code></pre>
<p><img src="OLDhypothesis_testing_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>qplot(x=xrange, y=dt(xrange, df = 24), geom=&quot;line&quot;,  main=&quot;Density of T-Distribution df=23&quot;) +
  geom_vline(xintercept = -12.4224, col=&quot;red&quot;) + 
  annotate(geom=&quot;text&quot;, x=-9, y=.3, label=&quot;Observed T&quot;, color=&quot;red&quot;)</code></pre>
<p><img src="OLDhypothesis_testing_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<p>Our T-test would return a very low p value, because it would be highly unlikely to get two sex groups with means as different as our baboons, if the variation was attributable only to chance. We know this because we know the distribution of the T statitic when the null hypothesis if true.</p>
</div>
</div>
</div>
<div id="if-you-only-remember-one-thing-from-this-class-remember-this" class="section level2">
<h2>If you only remember one thing from this class, remember this:</h2>
<div id="the-p-value-is-an-estimate-of-how-likely-our-data-are-assuming-the-null-hypothesis-is-true.-1" class="section level4">
<h4>The p-value is an estimate of how likely our data are, assuming the null hypothesis is true.</h4>
<hr />
<hr />
</div>
</div>
<div id="type-i-and-type-ii-errors." class="section level2">
<h2>Type I and Type II Errors.</h2>
<table>
<thead>
<tr class="header">
<th align="left">The Truth</th>
<th align="left">Retain <span class="math inline">\(H_0\)</span></th>
<th align="left">Reject <span class="math inline">\(H_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(H_0\)</span> True</td>
<td align="left">Correct!</td>
<td align="left">Type I error (<span class="math inline">\(\alpha\)</span>)</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(H_0\)</span> False</td>
<td align="left">Type II error (<span class="math inline">\(\beta\)</span>)</td>
<td align="left">Correct!</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="typeItype2.jpg" alt="type I, type II" />
<p class="caption">type I, type II</p>
</div>
<p><strong><em>Statistical power</em></strong> is related to Type II errors, and is calculated as <span class="math inline">\(1 - \beta\)</span>. This tells us how likely we are to detect an effect when one actually exists. Before starting a study it is worth doing a <strong><em>power analysis</em></strong> to determine the rate at which an effect of a given size will be detected with a given sample size.</p>
<p>Type I and Type II error rates are necessarily inversely related to one other, so to decrease one is to increase the other. This relationship is not simple, though. Type II error rates depend on a lot of things, like the sample size and strength of the effect.</p>
</div>
<div id="statistical-significance-versus-biological-significance" class="section level2">
<h2>Statistical Significance versus Biological Significance</h2>
<p>Given very large sample sizes, even tiny, virtually meaningless differences can become statistically signficant, because the statistical power increases as sample size increases. It is therefore important (especially in the days of easy access to lots of data) to be careful how you interpret statistical significance.</p>
<p>For example, imagine that you showed with vast sample sizes that two populations differ in height by an average of 0.6mm, and your p value was 0.00002. This is a very statistically signficant result, but it is unclear if this diference is large enough to have much biological meaning for the two populations. <strong><em>The overwhelming take-away message of this statistical test should be that the populations are almost the same.</em></strong></p>
</div>
<div id="dont-be-a-slave-to-p0.05" class="section level2">
<h2>Don’t be a slave to p&lt;0.05!</h2>
</div>
<div id="three-frameworks-for-testing-hypotheses" class="section level2">
<h2>Three Frameworks For Testing Hypotheses</h2>
<div id="our-example-data-ant-data-from-gotelli-ch-5" class="section level4">
<h4>Our example data: <a href="datasets/gotelli_ants.txt">Ant data</a> from Gotelli CH 5</h4>
</div>
<div id="read-this-data-into-r-yourself" class="section level4">
<h4>Read this data into R yourself</h4>
<p>Lets test the hypothesis that the number of ant nest in forests differs from the number of ant nests in fields.</p>
</div>
<div id="monte-carlo" class="section level3">
<h3>Monte Carlo</h3>
<p>Monte Carlo refers to a world-famous casino, in a town of the same name on the French Riviera (in the Principality of Monaco).</p>
<p>In Monte Carlo analysis data are randomly reshuffled over and over to specify the null hypothesis, and these reshufflings are compared against the observed data.</p>
<p>There are four steps:</p>
<ol style="list-style-type: decimal">
<li>Decide on a test statistic</li>
<li>By reshuffling, create a distribution of the test statistic that would be expected under the null hypothesis</li>
<li>Decided on a one-tailed or two-tailed test</li>
<li>Compare the observed to the null distribution and calculate the p value.</li>
</ol>
<div id="section" class="section level4">
<h4>1</h4>
<p>For our test statistic, we will use the absolute value of the mean of the forest ants minus the mean of the field. We will want to calculate this over and over, so we will make a function to do it.</p>
<pre class="r"><code>abs.mean &lt;- function(ant_counts, habitats) {
  means &lt;- tapply(ant_counts, habitats, FUN = mean)
  abs_diff &lt;- abs(means[2] - means[1])
  return(abs_diff)
}</code></pre>
</div>
</div>
<div id="parametric" class="section level3">
<h3>Parametric</h3>
</div>
<div id="bayesian" class="section level3">
<h3>Bayesian</h3>
<div class="figure">
<img src="frequentists_vs_bayesians.png" alt="frequentists_v_bayesians" />
<p class="caption">frequentists_v_bayesians</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
