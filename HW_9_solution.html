<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Homework #9 - Solution</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57395681-1', 'auto');
  ga('send', 'pageview');

</script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="icon" href="favicon.ico" type="image/x-icon">

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/textmate.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="octicons/octicons.css" type="text/css" />
<link rel="stylesheet" href="css/custom-style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<div id="navbar">
  <div id="navbar-container">
    <ul id="navbar-ul">
      <li><a href="index.html"><span class="mega-octicon octicon-home"></span></a></li>
      <li><a href="datasets.html">Data</a></li>
      <li><a href="schedule.html">Schedule</a></li>
      <li><a href="gettinghelp.html">Getting Help</a></li>
      <li><a href="ANTH6413_syllabus.docx">Syllabus</a></li>
    </ul>
  </div>
</div>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Homework #9 - Solution</h1>

</div>


<div id="pts-total" class="section level2">
<h2>7 pts total</h2>
</div>
<div id="problem-1" class="section level2">
<h2>Problem 1</h2>
<div id="a---1pt" class="section level3">
<h3>A - 1pt</h3>
<p>load <a href="http://hompal-stats.wabarr.com/datasets/DIK-scap.txt">this dataset</a> on scapula morphology in Pan, Homo and Gorilla, and the Dikika fossil child. Details on this data can be found in <a href="http://www.nature.com/nature/journal/v443/n7109/full/nature05047.html">Alemseged et al, 2006</a></p>
<pre class="r"><code>scap &lt;- read.table(&quot;http://hompal-stats.wabarr.com/datasets/DIK-scap.txt&quot;, header=TRUE)</code></pre>
</div>
<div id="b---1pt" class="section level3">
<h3>B - 1pt</h3>
<p>Calculate the natural log of all the numeric variables</p>
<pre class="r"><code># log all the measurements, excluding the first row
scap[,-1] &lt;- log(scap[,-1])</code></pre>
</div>
<div id="c---1pt" class="section level3">
<h3>C - 1pt</h3>
<p>Perform a principal components analysis on the data, using the <code>scale=TRUE</code> argument.</p>
<pre class="r"><code>PCA &lt;- prcomp(scap[,-1], scale=TRUE)</code></pre>
</div>
<div id="d---1pt" class="section level3">
<h3>D - 1pt</h3>
<p>Summarize the PCA, indicating what proportion of the variance is explained by each PC.</p>
<pre class="r"><code>library(pander)
pander(summary(PCA))</code></pre>
<table>
<caption>Principal Components Analysis (continued below)</caption>
<colgroup>
<col width="16%" />
<col width="9%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">PC6</th>
<th align="center">PC7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>SSFB</strong></td>
<td align="center">0.2849</td>
<td align="center">-0.4794</td>
<td align="center">-0.3599</td>
<td align="center">0.1391</td>
<td align="center">0.006651</td>
<td align="center">-0.2841</td>
<td align="center">0.2535</td>
</tr>
<tr class="even">
<td align="center"><strong>TOTB</strong></td>
<td align="center">0.3138</td>
<td align="center">-0.002348</td>
<td align="center">0.1169</td>
<td align="center">0.3155</td>
<td align="center">0.08805</td>
<td align="center">-0.05833</td>
<td align="center">0.2691</td>
</tr>
<tr class="odd">
<td align="center"><strong>SSFL</strong></td>
<td align="center">0.3094</td>
<td align="center">-0.1715</td>
<td align="center">-0.02247</td>
<td align="center">-0.2185</td>
<td align="center">-0.3935</td>
<td align="center">-0.149</td>
<td align="center">0.4956</td>
</tr>
<tr class="even">
<td align="center"><strong>ISFB</strong></td>
<td align="center">0.2838</td>
<td align="center">0.4969</td>
<td align="center">0.1318</td>
<td align="center">0.3677</td>
<td align="center">0.1642</td>
<td align="center">-0.08181</td>
<td align="center">0.289</td>
</tr>
<tr class="odd">
<td align="center"><strong>MOL</strong></td>
<td align="center">0.3122</td>
<td align="center">-0.0989</td>
<td align="center">-0.06965</td>
<td align="center">-0.2034</td>
<td align="center">-0.395</td>
<td align="center">0.2112</td>
<td align="center">-0.2716</td>
</tr>
<tr class="even">
<td align="center"><strong>SPL</strong></td>
<td align="center">0.3127</td>
<td align="center">-0.07363</td>
<td align="center">0.1511</td>
<td align="center">-0.1333</td>
<td align="center">-0.2372</td>
<td align="center">0.3627</td>
<td align="center">-0.1467</td>
</tr>
<tr class="odd">
<td align="center"><strong>ISFL</strong></td>
<td align="center">0.3067</td>
<td align="center">-0.1656</td>
<td align="center">0.561</td>
<td align="center">0.2791</td>
<td align="center">0.04359</td>
<td align="center">0.3501</td>
<td align="center">-0.07205</td>
</tr>
<tr class="even">
<td align="center"><strong>PSSFB</strong></td>
<td align="center">0.3056</td>
<td align="center">-0.1926</td>
<td align="center">-0.5038</td>
<td align="center">0.2785</td>
<td align="center">0.3962</td>
<td align="center">0.2007</td>
<td align="center">-0.355</td>
</tr>
<tr class="odd">
<td align="center"><strong>PISFB</strong></td>
<td align="center">0.2623</td>
<td align="center">0.6335</td>
<td align="center">-0.4102</td>
<td align="center">-0.01389</td>
<td align="center">-0.283</td>
<td align="center">0.07847</td>
<td align="center">-0.0721</td>
</tr>
<tr class="even">
<td align="center"><strong>GFL</strong></td>
<td align="center">0.3091</td>
<td align="center">0.1018</td>
<td align="center">0.05179</td>
<td align="center">-0.691</td>
<td align="center">0.5992</td>
<td align="center">0.08885</td>
<td align="center">0.1662</td>
</tr>
<tr class="odd">
<td align="center"><strong>GFB</strong></td>
<td align="center">0.3114</td>
<td align="center">0.04893</td>
<td align="center">0.2679</td>
<td align="center">-0.07613</td>
<td align="center">-0.007483</td>
<td align="center">-0.7307</td>
<td align="center">-0.5243</td>
</tr>
</tbody>
</table>
<table style="width:67%;">
<colgroup>
<col width="16%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">PC8</th>
<th align="center">PC9</th>
<th align="center">PC10</th>
<th align="center">PC11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>SSFB</strong></td>
<td align="center">-0.5254</td>
<td align="center">0.1767</td>
<td align="center">0.002452</td>
<td align="center">0.2963</td>
</tr>
<tr class="even">
<td align="center"><strong>TOTB</strong></td>
<td align="center">-0.1368</td>
<td align="center">-0.02837</td>
<td align="center">-0.06865</td>
<td align="center">-0.8249</td>
</tr>
<tr class="odd">
<td align="center"><strong>SSFL</strong></td>
<td align="center">0.6084</td>
<td align="center">-0.04769</td>
<td align="center">0.1707</td>
<td align="center">0.04814</td>
</tr>
<tr class="even">
<td align="center"><strong>ISFB</strong></td>
<td align="center">0.002558</td>
<td align="center">-0.3757</td>
<td align="center">-0.2915</td>
<td align="center">0.4202</td>
</tr>
<tr class="odd">
<td align="center"><strong>MOL</strong></td>
<td align="center">-0.03045</td>
<td align="center">-0.01236</td>
<td align="center">-0.7543</td>
<td align="center">-0.04605</td>
</tr>
<tr class="even">
<td align="center"><strong>SPL</strong></td>
<td align="center">-0.3429</td>
<td align="center">-0.5621</td>
<td align="center">0.4609</td>
<td align="center">0.02856</td>
</tr>
<tr class="odd">
<td align="center"><strong>ISFL</strong></td>
<td align="center">0.08873</td>
<td align="center">0.5397</td>
<td align="center">0.09695</td>
<td align="center">0.2184</td>
</tr>
<tr class="even">
<td align="center"><strong>PSSFB</strong></td>
<td align="center">0.4317</td>
<td align="center">-0.1453</td>
<td align="center">0.0852</td>
<td align="center">-0.009406</td>
</tr>
<tr class="odd">
<td align="center"><strong>PISFB</strong></td>
<td align="center">-0.117</td>
<td align="center">0.4301</td>
<td align="center">0.2635</td>
<td align="center">-0.04203</td>
</tr>
<tr class="even">
<td align="center"><strong>GFL</strong></td>
<td align="center">-0.07756</td>
<td align="center">0.1029</td>
<td align="center">-0.05026</td>
<td align="center">-0.0143</td>
</tr>
<tr class="odd">
<td align="center"><strong>GFB</strong></td>
<td align="center">0.05098</td>
<td align="center">-0.01994</td>
<td align="center">0.1052</td>
<td align="center">-0.009531</td>
</tr>
</tbody>
</table>
<table>
<caption>Table continues below</caption>
<colgroup>
<col width="38%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">PC1</th>
<th align="center">PC2</th>
<th align="center">PC3</th>
<th align="center">PC4</th>
<th align="center">PC5</th>
<th align="center">PC6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Standard deviation</strong></td>
<td align="center">3.175</td>
<td align="center">0.8487</td>
<td align="center">0.2788</td>
<td align="center">0.1932</td>
<td align="center">0.1732</td>
<td align="center">0.1418</td>
</tr>
<tr class="even">
<td align="center"><strong>Proportion of Variance</strong></td>
<td align="center">0.9164</td>
<td align="center">0.06549</td>
<td align="center">0.00707</td>
<td align="center">0.00339</td>
<td align="center">0.00273</td>
<td align="center">0.00183</td>
</tr>
<tr class="odd">
<td align="center"><strong>Cumulative Proportion</strong></td>
<td align="center">0.9164</td>
<td align="center">0.9819</td>
<td align="center">0.9889</td>
<td align="center">0.9923</td>
<td align="center">0.9951</td>
<td align="center">0.9969</td>
</tr>
</tbody>
</table>
<table style="width:96%;">
<colgroup>
<col width="40%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">PC7</th>
<th align="center">PC8</th>
<th align="center">PC9</th>
<th align="center">PC10</th>
<th align="center">PC11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Standard deviation</strong></td>
<td align="center">0.1232</td>
<td align="center">0.09186</td>
<td align="center">0.07545</td>
<td align="center">0.05686</td>
<td align="center">0.04102</td>
</tr>
<tr class="even">
<td align="center"><strong>Proportion of Variance</strong></td>
<td align="center">0.00138</td>
<td align="center">0.00077</td>
<td align="center">0.00052</td>
<td align="center">0.00029</td>
<td align="center">0.00015</td>
</tr>
<tr class="odd">
<td align="center"><strong>Cumulative Proportion</strong></td>
<td align="center">0.9983</td>
<td align="center">0.999</td>
<td align="center">0.9996</td>
<td align="center">0.9999</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
<div id="e---2pts" class="section level3">
<h3>E - 2pts</h3>
<p>Make a beautiful plot (using ggplot) of PC1 versus PC2 and another of PC2 versus PC3. Make sure the points for each extant taxon are surrounded with a polygon to ease visualization.</p>
<pre class="r"><code>## make taxon variable nicer to look at
taxon &lt;- scap$Taxon
levels(taxon) &lt;- c(&quot;Dikika&quot;, &quot;Gorilla&quot;, &quot;Human&quot;, &quot;Pan&quot;)

## make a dataframe with just the PC coordinates and taxon
DFforPlot &lt;- data.frame(PC1=PCA$x[,1], PC2=PCA$x[,2], PC3=PCA$x[,3], taxon=taxon)
gorilla &lt;- subset(DFforPlot, taxon==&quot;Gorilla&quot;)
pan &lt;- subset(DFforPlot, taxon==&quot;Pan&quot;)
human &lt;- subset(DFforPlot, taxon==&quot;Human&quot;)


ggplot(aes(x=PC1, y=PC2, color=taxon, fill=taxon), data=DFforPlot) + 
  theme_bw(30) +
  geom_polygon(aes(x=PC1, y=PC2), alpha=.3, data=gorilla[chull(gorilla$PC1, gorilla$PC2),]) + 
  geom_polygon(aes(x=PC1, y=PC2), alpha=.3, data=pan[chull(pan$PC1, pan$PC2),]) + 
  geom_polygon(aes(x=PC1, y=PC2), alpha=.3, data=human[chull(human$PC1, human$PC2),]) + 
  geom_point(size=5)</code></pre>
<p><img src="HW_9_solution_files/figure-html/unnamed-chunk-6-1.png" width="1440" /></p>
<pre class="r"><code>ggplot(aes(x=PC2, y=PC3, color=taxon, fill=taxon), data=DFforPlot) + 
  theme_bw(30) +
  geom_polygon(aes(x=PC2, y=PC3), alpha=.3, data=gorilla[chull(gorilla$PC2, gorilla$PC3),]) + 
  geom_polygon(aes(x=PC2, y=PC3), alpha=.3, data=pan[chull(pan$PC2, pan$PC3),]) + 
  geom_polygon(aes(x=PC2, y=PC3), alpha=.3, data=human[chull(human$PC2, human$PC3),]) + 
  geom_point(size=5)</code></pre>
<p><img src="HW_9_solution_files/figure-html/unnamed-chunk-6-2.png" width="1440" /></p>
</div>
<div id="f---1pt" class="section level3">
<h3>F - 1pt</h3>
<p>How do you interpret the first principal component? Justify your interpretation based on the variable loadings.</p>
<p>All of the variables load similarly and positively on the first PC. This is a common situation and reflects the size of the individual. This makes sense, as the most dramatic way that individuals vary from one another is in their size.</p>
<!-- ## Problem 2 -->
<!-- ### A - 1pt -->
<!-- load the [dataset from Reed 1997](http://hompal-stats.wabarr.com/datasets/Reed1997_modern_adaptations.txt) with proportions of large mammal adaptations from modern game parks -->
<!-- ```{r} -->
<!-- reed <- read.table("http://hompal-stats.wabarr.com/datasets/Reed1997_modern_adaptations.txt", header=T, sep=",") -->
<!-- ``` -->
<!-- ### B - 1pt -->
<!-- Perform a correspondence analysis on this data -->
<!-- ```{r} -->
<!-- library(ca) -->
<!-- myCA <- ca(reed[,6:12]) -->
<!-- ``` -->
<!-- ### C - 1pt -->
<!-- Print the results of the CA -->
<!-- ```{r} -->
<!-- myCA -->
<!-- ``` -->
<!-- ### D - 1pt -->
<!-- Make a beautiful ggplot of the results (Dimension 1 plotted against Dimension 2).  Hint: You will have to extract the `rowcoords` and `colcoords` from the CA result.  Use text labels instead of points.  Use the simplified habitat as the label for the localities, rather than the long site name.  Color code the labels for each site by the mean annual precipitation values, so you can see the impact of precipitation.  -->
<!-- ```{r fig.height=10, fig.width=15} -->
<!-- localityScoreDF <- data.frame(Dimension1 = myCA$rowcoord[,1], Dimension2=myCA$rowcoord[,2], rainfall=reed$Rainfall, hab=reed$Simplified.Habitat) -->
<!-- adaptationScoreDF <- data.frame(Dimension1 = myCA$colcoord[,1], Dimension2=myCA$colcoord[,2], names = myCA$colnames) -->
<!-- ggplot() +  -->
<!--   geom_text(aes(x=Dimension1, y=Dimension2, label=names), data=adaptationScoreDF, color="red") +  -->
<!--   geom_text(aes(x=Dimension1, y=Dimension2, label=hab, color=rainfall), data=localityScoreDF) -->
<!-- ``` -->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
